---
stepsCompleted: [1, 2, 3, 4, 5, 6, 7, 8]
---

# Workflow Creation Plan: sync-epics-stories

## Initial Project Context

- **Module:** bmm
- **Target Location:** _bmad-output/bmb-creations/workflows/sync-epics-stories
- **Created:** 2026-01-13

## Detailed Requirements

### 1. Workflow Purpose and Scope
- **Problem:** Synchronize epics and user stories documentation generated by Bmad (Markdown files) with a Jira project.
- **User:** Product Owner (PO) Team.
- **Main Outcome:**
  - Validated Jira configuration.
  - Epics and Stories created/synced in Jira.
  - Local documentation (`epics.md`, `stories.md`) updated with Jira Issue Keys and sync status.

### 2. Workflow Type
- **Type:** **Action Workflow** with interactive setup and decision points (Branching).

### 3. Workflow Flow and Structure (Action & Branching)
The workflow will follow a phased approach as detailed in `_bmad/bmm/data/docs.md`:

**Phase 0: Initialization & Configuration (Jira Setup Task)**
1.  **Check Config:** Check for `_bmad/jira_docs/project_config.yaml`.
2.  **Authenticate/Validate:** Use MCP to get accessible resources (Cloud ID).
3.  **Project Key:** Elicit from user.
4.  **Verify Access:** Use MCP to verify project access and get project name/URL.
5.  **Save Config:** Create/Update `project_config.yaml`.

**Phase 1: Bifurcation (Scope Selection)**
- User selects: [1] Epics, [2] Stories, [3] Both.

**Phase 2: Epic Synchronization (if selected)**
1.  **Load:** Read `_bmad-output/planning-artifacts/epics.md`.
2.  **Iterate:**
    - Check for existence in Jira (Idempotency check via JQL).
    - Create if missing (Issue Type: "Epic").
3.  **Update:** Append "Jira Sync Status" to `epics.md`.
4.  **Report:** Summary of created/skipped/failed.

**Phase 3: Story Synchronization (if selected)**
1.  **Load:** Read `_bmad-output/planning-artifacts/stories.md`.
2.  **Iterate:**
    - **Resolve Parent:** Find Jira Key of parent Epic from `epics.md`. Skip if missing.
    - Check for existence in Jira (Idempotency check).
    - Determine Issue Type ("Story" or localized "Historia").
    - Create if missing (linked to Parent Epic).
3.  **Update:** Append "Jira Sync Status" to `stories.md`.
4.  **Report:** Summary of created/skipped/failed.

### 4. User Interaction Style
- **Collaborative Setup:** Guided setup for credentials and project selection.
- **Autonomous Execution:** Once configured and scope selected, the sync process runs largely autonomously, reporting progress.

### 5. Instruction Style
- **Prescriptive:** Specific steps for MCP calls, strict rules for idempotency, and exact formatting for updating markdown files.

### 6. Input Requirements
- **Configuration:** Jira Project Key, User Authentication (via MCP).
- **Files:** `_bmad-output/planning-artifacts/epics.md`, `_bmad-output/planning-artifacts/stories.md`.

### 7. Output Specifications
- **Jira:** Created Epics and Stories.
- **Local Files:** Updated `epics.md` and `stories.md` with sync status/links.
- **Config File:** `_bmad/jira_docs/project_config.yaml`.
- **Console:** Progress logs and final summary reports.

### 8. Success Criteria
- **Zero Duplication:** Idempotency checks prevent creating duplicate tickets.
- **Correct Linking:** Stories are correctly linked to their parent Epics in Jira.
- **Traceability:** Local files contain direct links and IDs of created Jira issues.
- **Stability:** Handles authentication failures or missing files gracefully.

### 9. Technical Specifics (from docs.md)
- **MCP Server:** `mcp-atlassian` (or equivalent provided environment).
- **Tools:** `getAccessibleAtlassianResources`, `getVisibleJiraProjects`, `createJiraIssue`, `searchJiraIssuesUsingJql`.
- **Structure:** Sequential steps with a central branching menu.

## Tools Configuration

### Core BMAD Tools

- **Party-Mode**: Excluded (Technical workflow)
- **Advanced Elicitation**: Excluded (Technical workflow)
- **Brainstorming**: Excluded (Technical workflow)

### LLM Features

- **Web-Browsing**: Included - Use cases: Lookup Jira error codes or API nuances if needed.
- **File I/O**: Included - Operations: Read/Write markdown files and config.
- **Sub-Agents**: Excluded - Single thread execution for reliability.
- **Sub-Processes**: Excluded.

### Memory Systems

- **Sidecar File**: Included - Purpose: Backup context and session persistence.

### External Integrations

- **MCP Atlassian (Jira)**: Essential.
    - `getAccessibleAtlassianResources`
    - `getVisibleJiraProjects`
    - `createJiraIssue`
    - `searchJiraIssuesUsingJql`

### Installation Requirements

- **mcp-atlassian**: Must be installed and authenticated via `/mcp auth mcp-atlassian`.

## Output Format Design

**Format Type**: Mixed (Strict Template & Structured)

**Output Requirements**:
- **Configuration**: YAML file (`project_config.yaml`)
- **Status Updates**: Markdown blocks appended to existing files (`epics.md`, `stories.md`)
- **File Format**: YAML, Markdown

**Structure Specifications**:

**A. Configuration (`project_config.yaml`) - Strict Template:**
```yaml
project_key: "{{PROJECT_KEY}}"
project_name: "{{PROJECT_NAME}}"
cloud_id: "{{CLOUD_ID}}"
jira_url: "{{JIRA_URL}}"
```

**B. Sync Status Block (`.md` append) - Structured:**
```markdown
### Jira Sync Status
- **Status:** {{Synced | Skipped | Failed}}
- **Issue Key:** {{JIRA-KEY}}
- **Issue ID:** {{issue_id}}
- **Link:** {{issue_url}}
- **Last Sync:** {{timestamp}}
- **Notes:** {{notes}}
- **Last Updated:** {{current_date}}
```

**Template Information**:
- **Source**: Defined in workflow plan.
- **Placeholders**: `{{PROJECT_KEY}}`, `{{CLOUD_ID}}`, `{{JIRA-KEY}}`, etc.

**Special Considerations**:
- **Idempotency**: Must check existence before creating.
- **Traceability**: Must log specific Issue Keys to enable linking.

## Workflow Structure Design

### 1. Structure Overview
- **Type**: Multi-session Action Workflow
- **Role**: Jira Integration Specialist
- **Continuation Support**: YES (`step-01-init` + `step-01b-continue`)

### 2. Step Sequence

**Step 1: Init (`step-01-init.md`)**
- **Goal:** Detect existing workflow state or initialize.
- **Logic:** Check for `stepsCompleted` in output files.
- **Route:** Go to `step-01b` if resuming, or `step-02` for fresh run.

**Step 1b: Continue (`step-01b-continue.md`)**
- **Goal:** Resume context and route to the next pending step.

**Step 2: Configuration & Setup (`step-02-setup.md`)**
- **Goal:** Validate Jira configuration and access.
- **Actions:**
  - Check/Create `_bmad/jira_docs/project_config.yaml`.
  - Authenticate via MCP (`getAccessibleAtlassianResources`).
  - Elicit `project_key` if missing.
  - Verify access (`getVisibleJiraProjects`).
- **Output:** Validated configuration.

**Step 3: Scope Selection (`step-03-scope.md`)**
- **Goal:** User selects synchronization scope.
- **Menu Options:**
  - [1] **Epics Only** -> Load `step-04-epics.md`.
  - [2] **Stories Only** -> Load `step-05-stories.md`.
  - [3] **Both** -> Load `step-04-epics.md` (with logic to chain to `step-05`).

**Step 4: Epic Synchronization (`step-04-epics.md`)**
- **Goal:** Sync `epics.md` to Jira.
- **Actions:**
  - Read `epics.md`.
  - For each epic: Check existence (JQL) -> Create if missing (MCP) -> Update `epics.md`.
- **Logic:** If scope was "Both", load `step-05` next. Else, finish.

**Step 5: Story Synchronization (`step-05-stories.md`)**
- **Goal:** Sync `stories.md` to Jira, linking to Epics.
- **Actions:**
  - Read `stories.md`.
  - For each story: Find Parent Epic ID -> Check existence -> Create (linked) -> Update `stories.md`.
- **Completion:** Final report and workflow finish.

### 3. File Structure
- `.../workflows/sync-epics-stories/`
  - `workflow.md` (Main entry)
  - `steps/`
    - `step-01-init.md`
    - `step-01b-continue.md`
    - `step-02-setup.md`
    - `step-03-scope.md`
    - `step-04-epics.md`
    - `step-05-stories.md`

### 4. Data Flow
- **Inputs:** `project_config.yaml`, `epics.md`, `stories.md`, Jira API (MCP).
- **State:** Tracked in file frontmatter (`stepsCompleted`) and markdown content updates.
- **Outputs:** Created Jira Issues, updated markdown files.

## Build Summary

**Generated Files:**
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/workflow.md`
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/steps/step-01-init.md`
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/steps/step-01b-continue.md`
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/steps/step-02-setup.md`
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/steps/step-03-scope.md`
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/steps/step-04-epics.md`
- `_bmad-output/bmb-creations/workflows/sync-epics-stories/steps/step-05-stories.md`

**Status:**
- All files created successfully.
- Structure aligns with approved plan.
- Ready for review.

## Review and Completion

### Review Findings
- **File Structure**: Correctly mirrors the standard BMAD structure.
- **Configuration**: All paths use dynamic placeholders (`{project-root}`, etc.) for portability.
- **Compliance**: Steps follow the micro-file architecture (one step, one file).
- **Logic**: Continuation logic is properly implemented in Steps 1 and 1b.

### Deployment
- **Path**: `_bmad-output/bmb-creations/workflows/sync-epics-stories/workflow.md`
- **Execution**: Can be run immediately by an agent pointing to this path.
- **Testing**:
  1. Ensure `mcp-atlassian` is authenticated.
  2. Ensure `epics.md` and `stories.md` exist in `_bmad-output/planning-artifacts/`.
  3. Run the workflow.

### Final Approval
- User approved the design and build.
- Workflow ready for production use.